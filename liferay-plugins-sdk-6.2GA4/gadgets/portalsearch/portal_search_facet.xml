<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="Search Facet" author="gfbiodev"
		author_email="dev@gfbio.org" >
		<Require feature="pubsub-2">
			<Param name="topics">
				<Topic title="GFBio Search Facet" name="gfbio.search.facet" subscribe="true" publish="true"/>

			</Param>
		</Require>
		<Require feature="dynamic-height"/>
	</ModulePrefs>
	<Content type="html">
		<![CDATA[
		<html style="height: 100%;">
			<head  lang="en">
				<meta charset="UTF-8">
				<title>GFBio Search Facet</title>
				<script src="//code.jquery.com/jquery-1.10.2.min.js"	type="text/javascript"></script>
				<script src="//code.jquery.com/ui/1.10.2/jquery-ui.min.js"	type="text/javascript"></script>
				<script src="//gfbio-dev1.inf-bb.uni-jena.de/gfbioGA4/search/js/jquery.bonsai.min.js"	type="text/javascript"></script>
				<script src="//gfbio-dev1.inf-bb.uni-jena.de/gfbioGA4/search/js/tag-it.min.js" type="text/javascript" charset="utf-8"></script>
				<script src="//gfbio-dev1.inf-bb.uni-jena.de/gfbioGA4/search/js/facet.js?aa=456123"	type="text/javascript"></script>

				<link rel="stylesheet"	href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/smoothness/jquery-ui.min.css" />
				<link rel="stylesheet"	href="//gfbio-dev1.inf-bb.uni-jena.de/gfbioGA4/search/css/jquery.bonsai.min.css" />
				<link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1/themes/flick/jquery-ui.css">
				<link rel="stylesheet" type="text/css" href="//gfbio-dev1.inf-bb.uni-jena.de/gfbioGA4/search/css/jquery.tagit.min.css">
				<link rel="stylesheet"	href="//gfbio-dev1.inf-bb.uni-jena.de/gfbioGA4/search/css/search.css" />
				
				<script type="text/javascript">
					// start listening to main search interface gadget
					gadgets.HubSettings.onConnect = function(hub, suc, err) {
						gadgets.Hub.subscribe("gfbio.search.facet", writeFacetTree);
						gadgets.Hub.subscribe("gfbio.search.facetreset", resetFacet);
					};

					$(document).ready(function() { 
						// initiate the tags for facet
						var facetTags = $('#facetTags');
						facetTags.tagit({
							afterTagRemoved: function(evt, ui) {
								var tagName = facetTags.tagit('tagLabel', ui.tag);
								// console.log(':Facet: afterTagRemoved: ' + tagName);
								// remove term from facet tray
								removeFromFacetTray(tagName);
								// and re-query the result again
								fireFacetData();
							},
						});
						// disable the facet tag text box (only for displaying)
						$(document.getElementById('facetTags').getElementsByClassName('ui-widget-content')).attr("readOnly","true");
						addFacetDialogToPage();

					});


				</script>
			</head>
			<body style="height:100%;">
				<div id="search_facet">
					<div id="facetDiv" class="invisible">Filter Results: 
					<a href='#' onclick='resetFacetTray();return false;' style='font-size:11px;'>clear filters</a>
					<ul id="facetTags"></ul>
					</div>
					<div id="search_facet_tree">
					</div>
				</div>
				<input id="facetTray" type="hidden" value=""/>
			</body>
			
		</html>
	]]>

	</Content>
</Module>